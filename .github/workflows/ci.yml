# =====================================================
# GitHub Actions Workflow: Python CI for Math Operations
#
# This workflow runs pytest on every push or pull request
# to the main branch, ensuring all tests in the 'tests/'
# directory pass before changes are merged or deployed.
#
# Maintainer: DevOps/QA Automation Agent
# =====================================================

name: CI Pipeline

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  test:
    name: Run Pytest Tests (Python 3.10)
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python 3.10
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install pytest

      - name: Run pytest
        run: pytest tests/

      - name: Upload pytest results (on failure)
        if: failure()
        uses: actions/upload-artifact@v4
        with:
          name: pytest-failure-logs
          path: .
          retention-days: 5

# =====================================================
# Documentation:
#  - Triggered on push and pull_request to main branch.
#  - Uses Python 3.10, installs pytest from requirements.
#  - Runs all tests in the 'tests/' directory.
#  - Fails the workflow if any test fails.
#  - Artifacts (logs) are uploaded on failure for debugging.
#
# Troubleshooting Guide:
#  - If the workflow fails, check the 'Run pytest' step logs.
#  - Download failure artifacts for detailed logs.
#  - Ensure requirements.txt is up-to-date if you add dependencies.
#  - For missing dependencies, add them to requirements.txt.
#  - For import errors, verify PYTHONPATH and test file structure.
#
# Recommendations for Optimization & Scalability:
#  - Use a requirements.txt file for managing dependencies.
#  - Parallelize tests with pytest-xdist for large suites.
#  - Integrate code coverage (pytest-cov) for quality metrics.
#  - Add static analysis (flake8, mypy) for code quality.
#  - Cache pip dependencies for faster builds (actions/cache).
# =====================================================
