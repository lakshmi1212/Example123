# CI Pipeline for Python project using pytest
# This workflow is automatically generated based on default/math.json metadata.
#
# Triggers:
#   - On push to main branch
#   - On pull request targeting main branch
#
# Python Version: 3.10
# Test Runner: pytest
# Test Directory: tests/
#
# Troubleshooting:
#   - Ensure requirements.txt contains all dependencies, including pytest.
#   - Check test discovery: pytest will auto-discover tests in tests/.
#   - If a test fails, the workflow fails and logs will show failure reason.
#
# Optimization & Scalability:
#   - For large test suites, consider using test matrix or parallel jobs.
#   - Cache pip dependencies for faster builds.
#   - Integrate coverage reporting for deeper insights.

name: CI Pipeline

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python 3.10
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          if [ -f default/requirements.txt ]; then pip install -r default/requirements.txt; fi
          pip install pytest
        shell: bash

      - name: Run pytest tests
        run: pytest tests

      - name: Upload pytest results if failed
        if: failure()
        uses: actions/upload-artifact@v4
        with:
          name: pytest-failure-logs
          path: .

# Documentation:
# - This workflow will execute on every push or pull request to the main branch.
# - All tests in the tests/ directory are automatically discovered and run by pytest.
# - If any test fails, the workflow status will be failed.
# - For troubleshooting, review the logs in the Actions tab. Failure logs are uploaded as artifacts for failed runs.
# - To optimize further, see the Optimization & Scalability section above.
